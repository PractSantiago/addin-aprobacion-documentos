/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"f5a09422ee730da0375f.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(e,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,o){var i,a,c,s=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return i=e,a=0,c=n,f.n=t,u}};function m(e,t){for(a=e,c=t,r=0;!d&&s&&!o&&r<l.length;r++){var o,i=l[r],m=f.p,p=i[2];e>3?(o=p===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=m&&((o=e<2&&m<i[1])?(a=0,f.v=t,f.n=i[1]):m<p&&(o=e<3||i[0]>t||t>p)&&(i[4]=e,i[5]=t,f.n=p,a=0))}if(o||e>1)return u;throw d=!0,t}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,p),a=l,c=p;(r=a<2?n:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),m(a,c)):f.n=c:f.v=c);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(d=f.n<0)?c:e.call(t,f))!==u)break}catch(e){i=n,a=1,c=e}finally{s=1}}return{value:r,done:d}}}(e,i,a),!0),l}var u={};function s(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(t(r={},i,function(){return this}),r),m=d.prototype=s.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,t(m,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,i,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:p}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function c(e){n(a,o,i,c,u,"next",e)}function u(e){n(a,o,i,c,u,"throw",e)}c(void 0)})}}var o={correoRevisor:"practica.sis1@spradling.group",correoFirmante:"practica.sis4@spradling.group",urlPowerAutomate:""},i="",a=null,c=null;function u(e){return s.apply(this,arguments)}function s(){return s=r(e().m(function t(n){var o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,d("Aplicando firma al documento...","info"),Word&&Word.run){t.n=1;break}return d("⚠️ Word API no disponible. Usa Word de escritorio.","info"),t.a(2);case 1:return t.n=2,Word.run(function(){var t=r(e().m(function t(r){var o,a,c,u,s;return e().w(function(e){for(;;)switch(e.n){case 0:return(o=r.document.body).insertBreak(Word.BreakType.page,Word.InsertLocation.end),(a=o.insertParagraph("Firma",Word.InsertLocation.end)).styleBuiltIn=Word.Style.heading1,a.alignment=Word.Alignment.centered,(c=o.insertParagraph("",Word.InsertLocation.end)).alignment=Word.Alignment.centered,u=n.replace(/^data:image\/(png|jpeg|jpg|gif);base64,/,""),c.insertInlinePictureFromBase64(u,Word.InsertLocation.end),(s=o.insertParagraph("Firmado por: "+i+"\nFecha: "+(new Date).toLocaleString("es-ES"),Word.InsertLocation.end)).alignment=Word.Alignment.centered,s.font.size=10,e.n=1,r.sync();case 1:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:d("✅ Documento firmado correctamente.","exito"),t.n=4;break;case 3:t.p=3,d("❌ Error al aplicar la firma: "+(o=t.v).message,"error"),console.error(o);case 4:return t.a(2)}},t,null,[[0,3]])})),s.apply(this,arguments)}function l(){d("⚠️ La exportación PDF funciona mejor en Word Desktop.","info")}function d(e,t){var n=document.getElementById("mensaje");n.textContent=e,n.className=t,n.style.display="block"}function f(){a?u(a):document.getElementById("input-firma").click()}function m(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){c=e.target.result,localStorage.setItem("firma_usuario",c),u(a=c)},n.readAsDataURL(t)}}function p(){c&&u(c)}function g(){c=null}Office.onReady(function(e){e.host===Office.HostType.Word&&(console.log("Office listo en Word"),function(){try{!function(){try{if(Office.context&&Office.context.roamingSettings){var e=Office.context.roamingSettings.get("userEmail");if(e)return i=e,void(document.getElementById("nombre-usuario").textContent=i)}i=o.correoFirmante,document.getElementById("nombre-usuario").textContent=i+" (modo prueba)"}catch(e){i=o.correoFirmante,document.getElementById("nombre-usuario").textContent=i+" (modo prueba)"}}(),e=document.getElementById("seccion-enviar"),t=document.getElementById("seccion-firmar"),n=i.toLowerCase()===o.correoRevisor.toLowerCase(),r=i.toLowerCase()===o.correoFirmante.toLowerCase(),n&&(e.style.display="block"),r&&(t.style.display="block"),n||r||d("No tienes permisos para usar este Add-in.","error"),document.getElementById("btn-enviar").addEventListener("click",enviarParaAprobacion),document.getElementById("btn-firmar").addEventListener("click",f),document.getElementById("btn-seleccionar-archivo").addEventListener("click",function(){document.getElementById("input-firma").click()}),document.getElementById("input-firma").addEventListener("change",m),document.getElementById("btn-confirmar-firma").addEventListener("click",p),document.getElementById("btn-cambiar-firma").addEventListener("click",g),document.getElementById("btn-guardar-pdf").addEventListener("click",l),function(){try{var e=localStorage.getItem("firma_usuario");e&&e.length>100&&(a=e)}catch(e){}}(),document.getElementById("loading").style.display="none",document.getElementById("contenido").style.display="block"}catch(e){document.getElementById("loading").innerHTML="<p style='color:red'>Error: "+e.message+"</p>"}var e,t,n,r}())})}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map